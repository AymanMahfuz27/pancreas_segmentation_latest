/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/func_3d/function.py:41: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
INFO:root:Loaded checkpoint sucessfully
INFO:root:Namespace(net='sam2', encoder='vit_b', exp_name='pancreas_test_run', vis=False, train_vis=False, prompt='bbox', prompt_freq=2, pretrain=None, val_freq=1, gpu=True, gpu_device=0, image_size=1024, out_size=1024, distributed='0', dataset='pancreas', sam_ckpt='/work/09999/aymanmahfuz/ls6/checkpoints/sam2_hiera_small.pt', sam_config='sam2_hiera_t', video_length=2, b=1, lr=0.0001, weights=0, multimask_output=0, memory_bank_size=32, data_path='/scratch/09999/aymanmahfuz/pancreas_test_data', path_helper={'prefix': 'logs/pancreas_test_run_2024_12_16_18_22_35', 'ckpt_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Model', 'log_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Log', 'sample_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Samples'})
Namespace(net='sam2', encoder='vit_b', exp_name='pancreas_test_run', vis=False, train_vis=False, prompt='bbox', prompt_freq=2, pretrain=None, val_freq=1, gpu=True, gpu_device=0, image_size=1024, out_size=1024, distributed='0', dataset='pancreas', sam_ckpt='/work/09999/aymanmahfuz/ls6/checkpoints/sam2_hiera_small.pt', sam_config='sam2_hiera_t', video_length=2, b=1, lr=0.0001, weights=0, multimask_output=0, memory_bank_size=32, data_path='/scratch/09999/aymanmahfuz/pancreas_test_data', path_helper={'prefix': 'logs/pancreas_test_run_2024_12_16_18_22_35', 'ckpt_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Model', 'log_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Log', 'sample_path': 'logs/pancreas_test_run_2024_12_16_18_22_35/Samples'})
INFO:func_3d.dataset.pancreas:Found 80 cases for Training
Found 80 cases for Training
INFO:func_3d.dataset.pancreas:Found 20 cases for Test
Found 20 cases for Test
Epoch 0:   0%|          | 0/80 [00:00<?, ?img/s]Epoch 0:   0%|          | 0/80 [00:26<?, ?img/s]
Traceback (most recent call last):
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/train_3d.py", line 125, in <module>
    main()
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/train_3d.py", line 90, in main
    loss = function.train_sam(args, net, optimizer, None, nice_train_loader, epoch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/func_3d/function.py", line 114, in train_sam
    _, _, _ = net.train_add_new_bbox(
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/sam2_video_predictor.py", line 439, in train_add_new_bbox
    out_frame_idx, out_obj_ids, out_mask_logits = self.train_add_new_points(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/sam2_video_predictor.py", line 523, in train_add_new_points
    current_out, _ = self._run_single_frame_inference(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/sam2_video_predictor.py", line 1351, in _run_single_frame_inference
    pred_masks_gpu = fill_holes_in_mask_scores(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/utils/misc.py", line 254, in fill_holes_in_mask_scores
    labels, areas = get_connected_components(mask <= 0)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/utils/misc.py", line 61, in get_connected_components
    from sam2_train import _C
ImportError: /lib64/libc.so.6: version `GLIBC_2.32' not found (required by /home1/09999/aymanmahfuz/pancreas_project_latest/pancreas_segmentation_latest/sam2_train/_C.so)
